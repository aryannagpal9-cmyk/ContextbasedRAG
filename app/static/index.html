<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultra Doc-Intelligence</title>
    <link rel="stylesheet" href="/static/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>

<body>

    <div class="app-container">
        <!-- Sidebar: Upload & Status -->
        <aside class="sidebar">
            <header>
                <h1><i class="fa-solid fa-cube"></i> UltraShip</h1>
                <p style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.25rem;">Doc-Intelligence Module
                </p>
            </header>

            <section>
                <h2>Upload Document</h2>
                <div class="upload-area" id="dropZone">
                    <i class="fa-solid fa-cloud-arrow-up upload-icon"></i>
                    <p>Drag & drop PDF/DOCX here<br>or click to browse</p>
                    <input type="file" id="fileInput" class="hidden-input" accept=".pdf,.docx,.html">
                </div>

                <div id="fileStatus" class="file-info" style="display: none;">
                    <div>
                        <span class="status-indicator status-ready" id="statusDot"></span>
                        <span id="fileName">document.pdf</span>
                    </div>
                    <i class="fa-solid fa-check" style="color: var(--success-color);"></i>
                </div>
            </section>

            <section style="margin-top: auto;">
                <p style="font-size: 0.8rem; color: var(--text-secondary);">
                    ID: <span id="docId">Not Uploaded</span><br>
                    Chunks: <span id="chunkCount">-</span>
                </p>
            </section>
        </aside>

        <!-- Main Content: Tabs for Chat & Extraction -->
        <main class="main-content">
            <!-- Global Processing Overlay -->
            <div id="processingOverlay" class="processing-overlay">
                <div class="spinner"></div>
                <h2 style="margin-bottom: 0;">Processing Document</h2>
                <p style="color: var(--text-secondary);">Parsing, Chunking & Extracting Intelligence...</p>
            </div>

            <div class="tabs">
                <button class="tab-btn active" data-tab="chat">Chat</button>
                <button class="tab-btn" data-tab="extraction">Structured Extraction</button>
                <button class="tab-btn" data-tab="chunks">Processed Chunks</button>
            </div>

            <!-- Chat Tab -->
            <div id="chat" class="tab-content active">
                <div class="chat-messages" id="chatMessages">
                    <div class="message bot">
                        Hello! Upload a logistics document to verify rates, dates, and parties.
                    </div>
                </div>
                <div class="input-area">
                    <input type="text" id="chatInput" placeholder="Ask a question about the document..." disabled>
                    <button id="sendBtn" class="primary-btn" disabled>
                        <i class="fa-solid fa-paper-plane"></i>
                    </button>
                </div>
            </div>

            <!-- Extraction Tab -->
            <div id="extraction" class="tab-content">
                <div style="margin-bottom: 1rem; display: flex; align-items: center; gap: 1rem;">
                    <p style="color: var(--text-secondary);">Define schema to extract structured data.</p>
                    <button id="extractBtn" class="primary-btn" style="margin-left: auto;" disabled>
                        Extract Data
                    </button>
                    <button id="autoSchemaBtn" class="secondary-btn" disabled title="Auto-detect schema from document">
                        <i class="fa-solid fa-wand-magic-sparkles"></i> Auto-Schema
                    </button>
                </div>

                <div style="display: flex; gap: 1rem; height: 100%;">
                    <div style="flex: 1; display: flex; flex-direction: column;">
                        <h2>Schema</h2>
                        <textarea id="schemaInput" style="flex: 1; font-family: monospace; font-size: 0.9rem;">{
  "shipper": "string",
  "consignee": "string",
  "origin_city": "string",
  "destination_city": "string",
  "rate_amount": "number",
  "currency": "string",
  "pickup_date": "string"
}</textarea>
                    </div>
                    <div style="flex: 1; display: flex; flex-direction: column;">
                        <h2>Results</h2>
                        <div class="extraction-results">
                            <pre id="extractionOutput" class="json-viewer">// Extraction results will appear here</pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chunks Tab -->
            <div id="chunks" class="tab-content">
                <div style="height: 100%; display: flex; flex-direction: column;">
                    <div style="margin-bottom: 1rem;">
                        <h2>Document Chunks</h2>
                        <p style="color: var(--text-secondary); font-size: 0.9rem;">
                            View all text chunks extracted from the document, including their section and page number.
                        </p>
                    </div>
                    <div id="chunksList"
                        style="flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 0.75rem;">
                        <div style="color: var(--text-secondary); text-align: center; margin-top: 2rem;">
                            Upload a document to view chunks.
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="/static/app.js"></script>
</body>

</html>